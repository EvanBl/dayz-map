<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DayZ World Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="">
  <style>
    html, body, #map { height: 100%; margin: 0; padding: 0; }
    .leaflet-container { background: #0b0f14; }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <script>
    // -------- CONFIG: adjust if needed --------
    const BASE  = "https://EvanBl.github.io/dayz-map/"; // trailing slash
    const WORLD = "world";
    const VIEW  = "flat";
    const EXT   = "jpg";
    const TILE  = 128;

    // Set these to your min/max tile filenames you see in GitHub:
    // From your screenshots I can see down to about x=-18, y=-33 and up to ~x=6, y=4.
    // If you spot smaller/larger, update these four numbers.
    const MIN_X = -18;
    const MAX_X = 6;
    const MIN_Y = -33;
    const MAX_Y = 4;

    // A real tile to start on (must exist as <x>_<y>.jpg under its ten-group folder):
    const START_X = -10;
    const START_Y = -33;

    // ---- helpers ----
    // group folder is trunc(x/10) and trunc(y/10); trunc toward zero matches your folders (-33 -> -3, 17 -> 1)
    function group10(n) { return n < 0 ? Math.ceil(n / 10) : Math.floor(n / 10); }

    // Convert Leaflet's non-negative coords (0..W-1, 0..H-1) into your file coords (may be negative)
    function fileX(lx) { return MIN_X + lx; }
    function fileY(ly) { return MIN_Y + ly; }

    // Custom layer that adds the group folder "<gx>_<gy>/" and the real "<fx>_<fy>.jpg"
    const DynmapLayer = L.TileLayer.extend({
      getTileUrl: function (coords) {
        const fx = fileX(coords.x);
        const fy = fileY(coords.y);
        const gx = group10(fx);
        const gy = group10(fy);
        return `${BASE}tiles/${WORLD}/${VIEW}/${gx}_${gy}/${fx}_${fy}.${EXT}`;
      }
    });

    // Pixel bounds to keep panning within your map rectangle
    const widthTiles  = (MAX_X - MIN_X + 1);
    const heightTiles = (MAX_Y - MIN_Y + 1);
    const southWest = L.point(0, 0);
    const northEast = L.point(widthTiles * TILE, heightTiles * TILE);
    const pixelBounds = L.bounds(southWest, northEast);
    const latLngBounds = L.latLngBounds(
      L.point(pixelBounds.min.x, pixelBounds.min.y),
      L.point(pixelBounds.max.x, pixelBounds.max.y)
    );

    // Build the map
    const map = L.map('map', {
      crs: L.CRS.Simple,
      minZoom: 0,
      maxZoom: 0,
      zoomControl: true
    });

    // Add the custom tile layer
    new DynmapLayer('', { tileSize: TILE, noWrap: true }).addTo(map);

    // Converting a real file tile (START_X, START_Y) to Leaflet tile coords:
    const startLeafletX = START_X - MIN_X; // shift into 0..W-1
    const startLeafletY = START_Y - MIN_Y;

    // Center on that tile (convert tile coords to pixel coords)
    map.setView([startLeafletY * TILE, startLeafletX * TILE], 0);

    // Constrain panning to your map bounds
    map.setMaxBounds([
      [0, 0],
      [heightTiles * TILE, widthTiles * TILE]
    ]);
  </script>
</body>
</html>
